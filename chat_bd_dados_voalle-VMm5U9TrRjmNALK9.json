{"createdAt":"2025-09-01T11:21:00.523Z","updatedAt":"2025-09-01T16:52:15.000Z","id":"VMm5U9TrRjmNALK9","name":"CHAT_BD_DADOS_VOALLE","active":false,"isArchived":false,"nodes":[{"parameters":{"options":{}},"id":"4ff8aa4f-fe57-4d45-bbb0-cc5bb9bbe9fe","name":"When chat message received","type":"@n8n/n8n-nodes-langchain.chatTrigger","position":[320,224],"webhookId":"cf1de04f-3e38-426c-89f0-3bdb110a5dcf","typeVersion":1.1},{"parameters":{"options":{}},"id":"dea0273c-24fa-4cb8-ac0f-52f22a6a3e4e","name":"AI Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[624,224],"typeVersion":1.7},{"parameters":{"descriptionType":"manual","toolDescription":"Obtenha a defini√ß√£o da tabela para encontrar todas as colunas e tipos","operation":"executeQuery","query":"select\n  c.column_name,\n  c.data_type,\n  c.is_nullable,\n  c.column_default,\n  tc.constraint_type,\n  ccu.table_name AS referenced_table,\n  ccu.column_name AS referenced_column\nfrom\n  information_schema.columns c\nLEFT join\n  information_schema.key_column_usage kcu\n  ON c.table_name = kcu.table_name\n  AND c.column_name = kcu.column_name\nLEFT join\n  information_schema.table_constraints tc\n  ON kcu.constraint_name = tc.constraint_name\n  AND tc.constraint_type = 'FOREIGN KEY'\nLEFT join\n  information_schema.constraint_column_usage ccu\n  ON tc.constraint_name = ccu.constraint_name\nwhere\n  c.table_name = '{{ $fromAI(\"table_name\") }}'\n  AND c.table_schema = '{{ $fromAI(\"schema_name\") }}'\norder by\n  c.ordinal_position","options":{}},"id":"1106061f-45f8-4827-b19f-5f6f4587e68a","name":"Get Table Definition","type":"n8n-nodes-base.postgresTool","position":[1408,448],"typeVersion":2.5,"credentials":{"postgres":{"id":"VOePVehRmDnVynKO","name":"dbVoalle"}}},{"parameters":{"content":"### üë®‚Äçüé§ Configura√ß√£o\n1. Adicione suas credenciais do **postgresql** e do **OpenAI**.\n2. Clique no bot√£o **Chat** e comece a fazer perguntas ao seu banco de dados.\n3. Ative o fluxo de trabalho e voc√™ poder√° tornar o chat p√∫blico.","height":120,"width":560,"color":5},"id":"f8947223-1350-442d-9177-82b0df3a9989","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[320,64],"typeVersion":1},{"parameters":{},"id":"a72d286d-f3ab-4acd-9e9e-707b3e54891a","name":"Chat History","type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","position":[672,464],"typeVersion":1.3},{"parameters":{"content":"üõ†Ô∏è Ferramentas Utilizadas:\n1. Executar Consulta SQL: Utilizado para executar qualquer consulta gerada pelo agente.\n2. Obter Esquema do BD e Lista de Tabelas: Retorna a lista de todas as tabelas com o nome do esquema.\n3. Obter Defini√ß√£o de Tabela: Retorna detalhes da tabela, como nomes de colunas, chaves estrangeiras e mais, de uma tabela espec√≠fica em um esquema.","height":156,"width":562,"color":5},"id":"14cdfe27-ac2c-4cb5-bdf0-157410d74c44","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[992,608],"typeVersion":1},{"parameters":{"content":"üëÜ Voc√™ pode trocar isso por qualquer outro modelo de bate-papo de sua escolha.","height":99,"width":194,"color":5},"id":"ea6d1ddc-6824-466b-b847-e0ee94c2e519","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[496,576],"typeVersion":1},{"parameters":{"content":"üëÜ Voc√™ pode alterar a quantidade de mensagens que deseja manter usando a op√ß√£o `Comprimento da Janela de Contexto`. O padr√£o √© 5.","height":191,"width":194,"color":5},"id":"0f2d2775-121c-4e61-a8b6-b894795b27a6","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[704,576],"typeVersion":1},{"parameters":{"descriptionType":"manual","toolDescription":"Obtenha todos os dados do Postgres e certifique-se de anexar as tabelas com o esquema correto. Cada tabela est√° associada a algum esquema no banco de dados.","operation":"executeQuery","query":"{{ $fromAI(\"sql_query\", \"SQL Query\") }}","options":{}},"id":"cf69375c-d4bb-4b5e-a2bc-6b1b1091a01a","name":"Execute SQL Query","type":"n8n-nodes-base.postgresTool","position":[1008,448],"typeVersion":2.5,"credentials":{"postgres":{"id":"VOePVehRmDnVynKO","name":"dbVoalle"}}},{"parameters":{"descriptionType":"manual","toolDescription":"Obter lista de todas as tabelas com seus esquemas no banco de dados","operation":"executeQuery","query":"SELECT \n    table_schema,\n    table_name\nFROM information_schema.tables\nWHERE table_type = 'BASE TABLE'\n    AND table_schema NOT IN ('pg_catalog', 'information_schema')\nORDER BY table_schema, table_name;","options":{}},"id":"ee4289be-8316-4706-bfba-9ec6de7dd47a","name":"Get DB Schema and Tables List","type":"n8n-nodes-base.postgresTool","position":[1200,448],"typeVersion":2.5,"credentials":{"postgres":{"id":"VOePVehRmDnVynKO","name":"dbVoalle"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[496,432],"id":"510af850-4e55-4c96-92dd-76466088d0dd","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"twBQbhIybxyXrPTL","name":"Google Gemini(PaLM) Api account 2"}}}],"connections":{"Chat History":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Execute SQL Query":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Get Table Definition":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Get DB Schema and Tables List":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"d5f0ec10-af0d-49e2-b93c-d0e6618c7130","triggerCount":0,"shared":[{"createdAt":"2025-09-01T11:21:00.528Z","updatedAt":"2025-09-01T11:21:00.528Z","role":"workflow:owner","workflowId":"VMm5U9TrRjmNALK9","projectId":"2CRGWlpvxl6HNury"}],"tags":[]}